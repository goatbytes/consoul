{
  "created_at": "2025-11-14T19:09:28.276863",
  "updated_at": "2025-11-15T07:28:05.191209Z",
  "id": "SOUL-102",
  "uuid": "3f4a34a8-a3ea-4cb4-be18-543a3d8b6046",
  "title": "Add Jina AI Search as optional web_search backend",
  "description": "**As a** Consoul user\n**I want** to optionally use Jina AI Search for web searches\n**So that** I can get higher quality, LLM-optimized search results with semantic understanding\n\n**Context:**\nJina AI offers a Search API (https://s.jina.ai) that provides LLM-ready search results. Unlike DuckDuckGo and SearxNG which return raw web results, Jina Search provides:\n- Semantic search understanding\n- Pre-cleaned, LLM-optimized content\n- Structured JSON responses\n- Better result quality for AI applications\n\nFrom SOUL-91 research:\n- Free tier: 10M tokens (no credit card required)\n- API key needed but easy to obtain\n- Works alongside existing DuckDuckGo/SearxNG support\n\nThis complements existing web_search backends:\n- DuckDuckGo: Zero setup, 20 RPM, basic results\n- SearxNG: Self-hosted, unlimited, meta-search\n- Jina Search (NEW): Best quality, LLM-optimized, requires API key\n\n**Technical Notes:**\n- Jina Search API: https://s.jina.ai/?q={query}\n- Requires API key: https://jina.ai (free signup, 10M tokens)\n- Current implementation: src/consoul/ai/tools/implementations/web_search.py\n- Config model: src/consoul/config/models.py - WebSearchToolConfig\n- Pattern: Add Jina as third backend alongside SearxNG and DuckDuckGo\n\nPriority order (when all configured):\n1. Jina Search (if API key present) - Best quality\n2. SearxNG (if URL configured) - Self-hosted, unlimited\n3. DuckDuckGo - Zero-config fallback\n\n**Acceptance Criteria:**\n\n**Given** I have a Jina API key configured\n**When** I call web_search(\"Python programming\")\n**Then** Jina Search is used and returns LLM-optimized results\n\n**Given** Jina API key is set but quota is exceeded\n**When** I call web_search(\"test query\")\n**Then** fallback to SearxNG or DuckDuckGo occurs with warning log\n\n**Given** No Jina API key is configured\n**When** I call web_search(\"test query\")\n**Then** SearxNG or DuckDuckGo is used (existing behavior)\n\n**Given** Jina Search is configured\n**When** I inspect search results\n**Then** results include \"source\": \"jina\" field in metadata\n\n**Testing Considerations:**\n- Mock Jina API responses in unit tests\n- Test fallback chain: Jina \u2192 SearxNG \u2192 DuckDuckGo\n- Test API key validation\n- Test quota/rate limit handling\n- Test with actual Jina API (integration test)\n- Verify result format matches existing structure\n\n**Implementation Hints:**\n\n1. Enhance WebSearchToolConfig in config/models.py:\n```python\n# Jina Search settings (optional, best quality)\njina_api_key: str | None = Field(\n    default=None,\n    description=\"Jina AI API key for semantic search (get free key at jina.ai)\",\n)\njina_enabled: bool = Field(\n    default=True,\n    description=\"Enable Jina Search when API key is present\",\n)\n```\n\n2. Add to web_search.py:\n```python\ndef _execute_jina_search(\n    api_key: str,\n    query: str,\n    max_results: int,\n    timeout: int,\n) -> list[dict[str, Any]]:\n    \"\"\"Execute web search using Jina AI.\"\"\"\n    response = requests.get(\n        \"https://s.jina.ai/\",\n        params={\"q\": query},\n        headers={\"Authorization\": f\"Bearer {api_key}\"},\n        timeout=timeout,\n    )\n    # Parse and normalize results\n    ...\n```\n\n3. Update web_search() function logic:\n```python\n# Priority order\nif config.jina_api_key and config.jina_enabled:\n    try:\n        results = _execute_jina_search(...)\n        return results  # Best quality\n    except Exception:\n        logger.warning(\"Jina failed, trying SearxNG/DuckDuckGo\")\n\n# Existing SearxNG logic\nif config.searxng_url:\n    ...\n\n# Existing DuckDuckGo fallback\nresults = _execute_duckduckgo_search(...)\n```\n\n4. Update config example in docs:\n```yaml\nweb_search:\n  # Jina Search (best quality, requires free API key)\n  jina_api_key: ${JINA_API_KEY}  # Get from https://jina.ai\n  jina_enabled: true\n\n  # SearxNG (self-hosted)\n  searxng_url: http://localhost:8888\n\n  # DuckDuckGo (zero-config fallback)\n  region: wt-wt\n  safesearch: moderate\n```\n\n5. Documentation updates:\n- Add Jina Search to docs/tools.md web_search section\n- Update backend comparison table\n- Add setup instructions for getting Jina API key\n- Document priority order\n\nFiles to modify:\n- src/consoul/config/models.py (WebSearchToolConfig)\n- src/consoul/ai/tools/implementations/web_search.py (add Jina backend)\n- docs/tools.md (update web_search docs)\n- docs/research/read_url_tool_research.md (reference implementation)\n\n**Dependencies:**\n- Requests library (already installed)\n- SOUL-100 (SearxNG support) - builds on this\n\n**Notes:**\n- Jina API key in environment variable (JINA_API_KEY) or config\n- Free tier is generous (10M tokens, no CC required)\n- Optional feature - existing zero-config experience preserved\n- Consider adding to advanced/searxng-setup.md",
  "status": "done",
  "type": "feature",
  "priority": "medium",
  "labels": [
    "enhancement",
    "tools",
    "web",
    "ai",
    "search"
  ],
  "assignee": "jared@goatbytes.io",
  "reporter": "jared@goatbytes.io",
  "blocked_by": [],
  "blocks": [],
  "comments": [],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 0,
  "story_points": 3,
  "order": 0,
  "custom_fields": {},
  "_archive_metadata": {
    "archived_at": "2025-11-14T23:28:32.880652",
    "archived_from_status": "done",
    "archived_by": "gira-cli"
  }
}