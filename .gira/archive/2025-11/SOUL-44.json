{
  "created_at": "2025-11-09T20:15:24.461650",
  "updated_at": "2025-11-11T04:27:46.250955Z",
  "id": "SOUL-44",
  "uuid": "38af4124-ee28-4a5e-9998-d42cdad8315e",
  "title": "Implement model & provider picker (separate from profiles)",
  "description": "# Redesign Model & Provider Picker (Separate from Profiles)\n\n## User Story\n**As a** Consoul user\n**I want** to select AI models and providers directly from the UI\n**So that** I can quickly switch between different AI providers and models without editing config files\n\n## Description\n\nRedesign SOUL-44 to provide a **model-centric picker** with provider selection, completely separate from profile management. Users should be able to:\n- Switch AI providers (OpenAI, Anthropic, Google, Ollama)\n- Select specific models within each provider\n- See model metadata (context window, cost, capabilities)\n- Switch models without affecting other profile settings\n- Preserve conversation context when switching\n\n## Context\n\n**Current implementation (completed in commit 3b3daf6):**\n- Opens ProfileSelectorModal when clicking model label\n- Shows configuration profiles (default, code-review, creative)\n- Switching profile changes model + system prompt + all settings\n\n**Problem:**\n- Users expect to select specific models (gpt-4, claude-3-opus), not profiles\n- No way to switch providers independently\n- Profile concept conflates \"which AI to use\" with \"how to use AI\"\n\n**New approach:**\n- Separate profiles (settings presets) from model selection\n- Model picker shows provider tabs + model list\n- Profile selector becomes separate (accessed via Profile label in top bar)\n\n## Visual Design\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502              Select AI Model & Provider                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                          \u2502\n\u2502  Provider: [OpenAI \u25bc] [Anthropic] [Google] [Ollama]    \u2502\n\u2502            \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                     \u2502\n\u2502                                                          \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 \u2713 gpt-4o              128K ctx    Moderate   \u2b50\u2b50\u2b50 \u2502 \u2502\n\u2502  \u2502   gpt-4-turbo         128K ctx    Expensive  \u2b50\u2b50\u2b50 \u2502 \u2502\n\u2502  \u2502   gpt-4               8K ctx      Expensive  \u2b50\u2b50\u2b50 \u2502 \u2502\n\u2502  \u2502   gpt-3.5-turbo       16K ctx     Cheap      \u2b50\u2b50  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                          \u2502\n\u2502  Search: [________________]                             \u2502\n\u2502                                                          \u2502\n\u2502  [ Select Model ]  [ Cancel ]                           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n## Technical Notes\n\n**Files to Modify:**\n- src/consoul/tui/widgets/contextual_top_bar.py\n  - Add `current_provider: reactive[str]` property\n  - Update model label to show: \"\ud83e\udd16 OpenAI: gpt-4o\"\n  - Make Profile label clickable (triggers ProfileSelectorModal)\n\n**Files to Create:**\n- src/consoul/tui/widgets/model_picker_modal.py\n  - Provider tabs (Horizontal with clickable Labels)\n  - Model DataTable (filtered by active provider)\n  - Search input for model filtering\n  - Returns: `tuple[provider, model_name] | None`\n\n**Files to Update:**\n- src/consoul/tui/app.py\n  - Replace `on_contextual_top_bar_model_selection_requested()` \n  - Use ModelPickerModal instead of ProfileSelectorModal\n  - Add `_switch_provider_and_model(provider, model_name)` method\n  - Update top bar to track provider separately\n  - Add `on_contextual_top_bar_profile_selection_requested()` handler\n\n**Keep existing ProfileSelectorModal:**\n- Still useful for switching entire settings presets\n- Accessed via clicking \"Profile: default\" label in top bar\n- Profiles define: system prompts, context settings, conversation config\n- Profiles no longer directly tied to specific models\n\n## Implementation Steps\n\n1. Create ModelPickerModal widget with provider tabs\n2. Update ContextualTopBar to show provider + model\n3. Make Profile label clickable in ContextualTopBar\n4. Add _switch_provider_and_model() to app.py\n5. Replace model selection handler to use ModelPickerModal\n6. Add profile selection handler to use ProfileSelectorModal\n7. Update reactive properties to track provider separately\n\n## Acceptance Criteria\n\n**Given** I click the model label in ContextualTopBar\n**When** the ModelPickerModal opens\n**Then** I see provider tabs and models for current provider highlighted\n\n**Given** I'm viewing OpenAI models\n**When** I click the Anthropic tab\n**Then** the model list updates to show Claude models\n\n**Given** I select a different model\n**When** I confirm selection\n**Then** only the model/provider changes (profile settings preserved)\n\n**Given** I click the profile label in ContextualTopBar\n**When** the ProfileSelectorModal opens\n**Then** I see available profiles (default, code-review, creative, fast)\n\n**Given** I'm in the middle of a conversation\n**When** I switch models or providers\n**Then** conversation context is preserved\n\n## Dependencies\n\n**Prerequisites:**\n- SOUL-55 (ContextualTopBar with clickable model/profile labels)\n\n## Notes\n\nThis ticket supersedes the previous SOUL-44 implementation which conflated profiles with model selection. The new design clearly separates:\n- **Model/Provider selection**: Which AI to use (frequent switching)\n- **Profile selection**: How to use AI - system prompts, context settings (infrequent switching)",
  "status": "done",
  "type": "feature",
  "priority": "medium",
  "labels": [
    "tui",
    "modals",
    "ai",
    "config"
  ],
  "assignee": "jared@goatbytes.io",
  "reporter": "jared@goatbytes.io",
  "epic_id": "EPIC-003",
  "blocked_by": [
    "SOUL-55",
    "SOUL-56"
  ],
  "blocks": [],
  "comments": [],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 0,
  "story_points": 5,
  "order": 0,
  "custom_fields": {},
  "_archive_metadata": {
    "archived_at": "2025-11-14T23:28:33.554930",
    "archived_from_status": "done",
    "archived_by": "gira-cli"
  }
}