{
  "created_at": "2025-12-07T19:39:19.720064",
  "updated_at": "2025-12-23T15:14:07.211129",
  "id": "SOUL-237",
  "uuid": "ebbcfef4-17ad-40e4-b8f7-90a7e63b6e61",
  "title": "Create consoul.web module with FastAPI integration helpers",
  "description": "**As a** backend developer\n**I want** ready-to-use FastAPI integration helpers and Pydantic models\n**So that** I can quickly build HTTP/WebSocket endpoints with Consoul\n\n**Context:**\nChatGPT analysis (lines 2239-2395) recommends FastAPI as the standard backend framework for Consoul web integration. Need production-ready helpers for:\n- HTTP POST /chat endpoint\n- Pydantic request/response models\n- Error handling middleware\n- Session management utilities\n\nThis module should NOT be a full framework, just thin helpers that wrap Consoul SDK for web use. LangChain, not Consoul, handles orchestration.\n\n**Technical Notes:**\n- Create: src/consoul/web/__init__.py\n- Create: src/consoul/web/models.py (Pydantic models)\n- Create: src/consoul/web/endpoints.py (FastAPI helpers)\n- Dependencies: fastapi, pydantic (optional - extra group)\n- Pattern: Thin wrappers, not opinionated framework\n- Align with: ConsoulResponse model (src/consoul/sdk.py:44-77)\n- HTTP contract: {\"messages\": [...], \"model\": \"...\", \"stream\": false}\n- Response: {\"content\": \"...\", \"tokens\": 0, \"model\": \"...\", \"usage\": {...}}\n\n**Acceptance Criteria:**\n\n**Given** I have FastAPI installed with consoul[web]\n**When** I import from consoul.web\n**Then** I can access ChatRequest, ChatResponse Pydantic models\n\n**Given** I create a POST /chat endpoint\n**When** I use create_chat_handler() helper\n**Then** it returns a FastAPI route handler that processes chat requests\n\n**Given** a client sends ChatRequest JSON\n**When** the endpoint processes it\n**Then** returns structured ChatResponse with content, tokens, model\n\n**Given** an error occurs during processing\n**When** an exception is raised\n**Then** returns proper HTTP 500 with error details in standard format\n\n**Given** I need session management\n**When** I use get_or_create_session() helper\n**Then** retrieves or creates isolated Consoul instance for session_id\n\n**Testing Considerations:**\n- Test FastAPI endpoint integration (TestClient)\n- Test Pydantic model validation\n- Test error responses (400, 500)\n- Test with actual Consoul SDK\n- Test session helpers\n- Mock LangChain model responses\n\n**Implementation Hints:**\n- Pydantic models align with SDK types:\n  - ChatRequest(messages: list[ChatMessage], model: str, stream: bool)\n  - ChatResponse(content: str, tokens: int, model: str, usage: dict)\n  - ChatMessage(role: Role, content: str, id: str)\n- Helper pattern: def create_chat_handler(consoul: Consoul) -> Callable\n- Error handling: FastAPI HTTPException with details\n- Session storage: Dict[str, Consoul] (in-memory, Redis for production)\n- Optional dependencies: pyproject.toml [web] extras\n- Reference: ChatGPT ProtoStack backend design (lines 2026-2395)\n- Example: examples/backend/fastapi_basic.py",
  "status": "done",
  "type": "feature",
  "priority": "high",
  "labels": [
    "backend",
    "api",
    "enhancement"
  ],
  "assignee": "jared@goatbytes.io",
  "reporter": "jared@goatbytes.io",
  "epic_id": "EPIC-011",
  "blocked_by": [],
  "blocks": [],
  "comments": [
    {
      "created_at": "2025-12-23T15:14:07.211029",
      "updated_at": "2025-12-23T15:14:07.211030",
      "id": "20251223151407-9bb73124",
      "ticket_id": "SOUL-237",
      "author": "jared@goatbytes.io",
      "content": "Superseded by EPIC-016 (Production SDK Hardening) and EPIC-017 (Production Server Package).\n\nOriginal ticket focused on basic FastAPI helpers and Pydantic models. Replaced with comprehensive production-ready implementation:\n\n- SOUL-292: Tool filtering and sandboxing (security for multi-tenant)\n- SOUL-293: Document processing (legal industry PDFs/DOCX)\n- SOUL-294: Security middleware (auth, rate limiting, CORS)\n- SOUL-295: Audit logging (compliance requirements)\n- SOUL-296: Server factory (create_server with production defaults)\n- SOUL-297: HTTP chat endpoint (session management)\n- SOUL-298: WebSocket streaming (real-time responses)\n- SOUL-299: Observability (LangSmith, OpenTelemetry, Prometheus)\n\nNew tickets provide legal industry-focused implementation with compliance, security, and cloud deployment support.",
      "edited": false,
      "edit_count": 0,
      "is_ai_generated": false,
      "attachments": [],
      "attachment_count": 0
    }
  ],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 1,
  "story_points": 8,
  "order": 0,
  "custom_fields": {},
  "_archive_metadata": {
    "archived_at": "2025-12-23T23:19:07.343035+00:00",
    "archived_from_status": "done",
    "archived_by": "gira-cli"
  }
}