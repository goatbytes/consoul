{
  "created_at": "2025-11-13T14:34:47.578182",
  "updated_at": "2025-11-13T14:34:47.578191",
  "id": "SOUL-95",
  "uuid": "071afcfb-e35e-4744-b03f-f6f866e93cdc",
  "title": "Add caching for code search results",
  "description": "**As a** Consoul developer\n**I want** parsed ASTs cached on disk\n**So that** repeated code searches are 10x faster\n\n**Context:**\nParsing large codebases to AST is expensive (SOUL-97). Cache parsed trees keyed by file path + mtime. Aider uses diskcache successfully.\n\n**Decision: Add diskcache as core dependency**\nAdd to SOUL-94 task or create sub-task\n\n**Technical Notes:**\n- src/consoul/ai/tools/cache.py - CodeSearchCache class\n- Use diskcache.Cache (SQLite-backed)\n- Store: ~/.consoul/cache/code-search.v1/\n- Key: (file_path, mtime, cache_version)\n- Value: Parsed AST + symbol table\n- Similar: src/consoul/ai/tools/audit.py (uses file cache)\n- Reference: Aider aider/repomap.py CACHE_VERSION pattern\n\n**Acceptance Criteria:**\n**Given** first search of Python file\n**When** code_search parses file\n**Then** AST stored in cache with mtime\n\n**Given** second search, file unchanged\n**When** code_search checks cache\n**Then** cached AST used, 10x faster than parse\n\n**Given** file modified (mtime changed)\n**When** code_search checks cache\n**Then** cache miss, re-parse, update cache\n\n**Given** cache exceeds size limit (100MB default)\n**When** adding new entries\n**Then** LRU eviction maintains limit\n\n**Given** cache version upgraded (v1 â†’ v2)\n**When** loading old cache\n**Then** cache invalidated, directory renamed\n\n**Testing:**\n- Mock diskcache, test hit/miss logic\n- Test mtime invalidation\n- Test size limits and LRU\n- Benchmark: parse vs cache (expect 10x)\n- Thread safety: concurrent cache access\n\n**Story Points:** 5\n**Dependencies:** SOUL-94 (add diskcache), SOUL-97 (integrates cache)",
  "status": "backlog",
  "type": "feature",
  "priority": "medium",
  "labels": [],
  "reporter": "jared@goatbytes.io",
  "epic_id": "EPIC-006",
  "blocked_by": ["SOUL-94"],
  "blocks": [],
  "comments": [],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 0,
  "order": 0,
  "custom_fields": {}
}