{
  "created_at": "2025-11-18T23:43:17.280642",
  "updated_at": "2025-11-19T18:55:30.905107Z",
  "id": "SOUL-136",
  "uuid": "49b122ab-de28-4f05-8d91-0d03288b93eb",
  "title": "Add profile creation and editing UI in TUI",
  "description": "**As a** Consoul TUI user\n**I want** to create and edit custom profiles directly from the TUI\n**So that** I can manage my configuration profiles without manually editing YAML files\n\n**Context:**\nCurrently, users can switch between existing profiles using the ProfileSelectorModal (Ctrl+P), but there's no way to create new profiles or edit existing ones from the TUI. Users must manually edit ~/.consoul/config.yaml to create custom profiles, which is error-prone and requires knowledge of the config structure.\n\nThe TUI has:\n- ProfileSelectorModal for selecting profiles (src/consoul/tui/widgets/profile_selector_modal.py)\n- Profile switching via _switch_profile() (src/consoul/tui/app.py:2432)\n- save_config() function available (src/consoul/config/loader.py:473)\n- 4 built-in profiles: default, code-review, creative, fast (src/consoul/config/profiles.py)\n\nProfile structure (src/consoul/config/models.py:1191-1221):\n- name: str (required, unique identifier)\n- description: str (required)\n- system_prompt: str | None\n- conversation: ConversationConfig (persist, db_path, auto_resume, etc.)\n- context: ContextConfig (max_context_tokens, include_system_info, etc.)\n\n**Research:**\n- Similar tools like aider allow profile editing via UI\n- Current ProfileSelectorModal is view-only, showing DataTable with profiles\n- ConsoulConfig.profiles stores custom profiles (dict[str, ProfileConfig])\n- Built-in profiles from get_builtin_profiles() are read-only\n- Config saved to ~/.consoul/config.yaml via save_config()\n\n**Technical Notes:**\n- Create ProfileEditorModal widget for create/edit operations\n- Use Textual Input widgets for name, description\n- Use TextArea for multi-line system_prompt editing\n- Use toggle/input widgets for conversation settings (persist, auto_resume, retention_days, etc.)\n- Use toggle/input widgets for context settings (max_context_tokens, include_system_info, etc.)\n- Implement form validation using Pydantic ProfileConfig\n- Add \"Create New\" button to ProfileSelectorModal\n- Add \"Edit\" button/action for custom profiles (disable for built-ins)\n- Add \"Delete\" action for custom profiles (with confirmation)\n- Save changes via save_config() to ~/.consoul/config.yaml\n- Update ConsoulConfig.profiles dict when creating/editing\n- Refresh ProfileSelectorModal after changes\n\n**Implementation Hints:**\n- Create src/consoul/tui/widgets/profile_editor_modal.py\n- Model after existing modals (ProfileSelectorModal, ExportModal, SettingsScreen)\n- Use Vertical/Horizontal containers for form layout\n- Group settings into sections: Basic Info, System Prompt, Conversation, Context\n- Implement validation on submit (check name uniqueness, required fields)\n- Handle edit mode vs create mode (populate fields vs empty)\n- Add keybindings: Ctrl+S (save), Escape (cancel)\n- Show success/error notifications after save\n- Consider using TabbedContent for organized settings sections\n\n**Files to Create/Modify:**\n- src/consoul/tui/widgets/profile_editor_modal.py (NEW)\n- src/consoul/tui/widgets/__init__.py (export ProfileEditorModal)\n- src/consoul/tui/widgets/profile_selector_modal.py (add Create/Edit/Delete buttons)\n- src/consoul/tui/app.py (add handler for profile create/edit/delete actions)\n\n**Acceptance Criteria:**\n\n**Given** I'm in the ProfileSelectorModal\n**When** I click \"Create New\" button\n**Then** ProfileEditorModal opens with empty form\n\n**Given** I'm creating a new profile in ProfileEditorModal\n**When** I fill in name \"my-custom\", description \"My custom profile\", and other settings\n**And** I save the profile\n**Then** the profile is added to config and saved to ~/.consoul/config.yaml\n**And** I see a success notification\n**And** the new profile appears in ProfileSelectorModal\n\n**Given** I'm editing an existing custom profile\n**When** I modify the description or settings\n**And** I save the changes\n**Then** the profile is updated in config and saved to disk\n**And** I see a success notification\n\n**Given** I try to create a profile with an existing name\n**When** I attempt to save\n**Then** I see a validation error: \"Profile name already exists\"\n\n**Given** I try to create a profile with empty name or description\n**When** I attempt to save\n**Then** I see validation errors for required fields\n\n**Given** I'm editing a built-in profile (default, code-review, creative, fast)\n**When** I try to save changes\n**Then** I see an error: \"Built-in profiles cannot be modified. Create a copy instead.\"\n\n**Given** I have a custom profile selected\n**When** I click \"Delete\" and confirm\n**Then** the profile is removed from config and saved\n**And** the ProfileSelectorModal refreshes without that profile\n\n**Given** I'm in ProfileEditorModal\n**When** I press Escape or click Cancel\n**Then** the modal closes without saving changes\n\n**Testing Considerations:**\n- Test profile creation with all field types\n- Test validation: duplicate names, empty fields, invalid values\n- Test editing existing custom profiles\n- Test that built-in profiles cannot be edited/deleted\n- Test delete confirmation flow\n- Test config file persistence after create/edit/delete\n- Test form validation with Pydantic ProfileConfig\n- Test cancel/escape behavior (no changes saved)\n- Test UI layout on different terminal sizes\n- Manual testing of YAML file output format\n\n**Dependencies:**\n- SOUL-77 (ConversationConfig support) - ensures conversation settings work correctly",
  "status": "done",
  "type": "feature",
  "priority": "medium",
  "labels": [
    "tui",
    "config",
    "enhancement",
    "ux-improvement"
  ],
  "reporter": "jared@goatbytes.io",
  "blocked_by": [],
  "blocks": [],
  "comments": [],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 0,
  "story_points": 8,
  "order": 0,
  "custom_fields": {}
}