{
  "created_at": "2025-11-29T13:26:24.880369",
  "updated_at": "2025-11-29T21:36:10.237613Z",
  "id": "SOUL-190",
  "uuid": "f6bbf0e8-7923-46c4-8725-59d0157abf68",
  "title": "Add async _async_initialize() method with progress tracking",
  "description": "**As a** Consoul developer\n**I want** an async _async_initialize() method that orchestrates app initialization with progress tracking\n**So that** the UI remains responsive while showing real-time progress updates during startup\n\n**Context:**\nAfter extracting initialization logic into separate methods (Phase 2), we need to create the orchestration method that calls them asynchronously while updating the loading screen. This is the core integration that ties together the extracted methods with the LoadingScreen widget.\n\nThis method will:\n- Call each initialization method in sequence\n- Update loading screen progress at each step\n- Handle errors gracefully with proper cleanup\n- Use run_in_thread() for blocking operations\n- Track initialization state with flags\n\n**Technical Notes:**\n- File: src/consoul/tui/app.py\n- Create async def _async_initialize(self) -> None\n- Call from on_mount() via self.call_later() or @work decorator\n- Update loading screen via self.screen.update_progress(message, percentage)\n- Use try/except blocks for each step with cleanup\n- Set _initialization_complete flag at the end\n- Progress percentages: config=10%, model=40%, conversation=50%, tools=60%, binding=80%, resume=90%, complete=100%\n\n**Acceptance Criteria:**\n\n**Given** on_mount() has pushed the LoadingScreen\n**When** _async_initialize() is called\n**Then** it updates progress from 0% to 100% without blocking the UI\n\n**Given** any initialization step fails\n**When** an exception is raised\n**Then** the error is caught and InitializationErrorScreen is shown\n\n**Given** initialization completes successfully\n**When** progress reaches 100%\n**Then** the loading screen fades out and main UI appears\n\n**Testing Considerations:**\n- Test with fast initialization (<1s) - progress should still be visible\n- Test with slow initialization (>5s) - progress updates smoothly\n- Test network failures during AI model init\n- Test invalid config file handling\n- Test auto-resume with large conversation history\n- Verify no UI freezing at any step\n- Test Ctrl+C cancellation during init\n\n**Implementation Hints:**\n```python\nasync def _async_initialize(self) -> None:\n    \"\"\"Initialize app components with progress updates.\"\"\"\n    loading_screen = self.screen\n\n    try:\n        # Step 1: Load config (10%)\n        loading_screen.update_progress(\"Loading configuration...\", 10)\n        consoul_config = await self.run_in_thread(self._load_config)\n\n        # Step 2: Initialize AI model (40%)\n        loading_screen.update_progress(\"Connecting to AI provider...\", 40)\n        self.chat_model = await self.run_in_thread(\n            self._initialize_ai_model, consoul_config\n        )\n\n        # Step 3: Create conversation (50%)\n        loading_screen.update_progress(\"Initializing conversation...\", 50)\n        self.conversation = await self.run_in_thread(\n            self._initialize_conversation, consoul_config, self.chat_model\n        )\n\n        # Step 4: Load tools (60%)\n        loading_screen.update_progress(\"Loading tools...\", 60)\n        self.tool_registry = await self.run_in_thread(\n            self._initialize_tool_registry, consoul_config\n        )\n\n        # Step 5: Bind tools (80%)\n        loading_screen.update_progress(\"Binding tools to model...\", 80)\n        self.chat_model = await self.run_in_thread(\n            self.tool_registry.bind_to_model, self.chat_model\n        )\n\n        # Step 6: Auto-resume if enabled (90%)\n        if self._should_auto_resume:\n            loading_screen.update_progress(\"Restoring conversation...\", 90)\n            await self.run_in_thread(\n                self._auto_resume_if_enabled, self.conversation, self._profile\n            )\n\n        # Step 7: Complete (100%)\n        loading_screen.update_progress(\"Ready!\", 100)\n        await asyncio.sleep(0.5)\n\n        # Fade out and show main UI\n        await loading_screen.fade_out(duration=0.5)\n        self.pop_screen()\n\n        self._initialization_complete = True\n\n    except Exception as e:\n        self.log.error(f\"Initialization failed: {e}\")\n        self.push_screen(InitializationErrorScreen(error=e))\n```\n\n**Dependencies:**\n- Requires Phase 2 completion (extracted methods)\n- Blocks Phase 4 (on_mount integration)",
  "status": "todo",
  "type": "task",
  "priority": "high",
  "labels": [
    "tui",
    "core",
    "async"
  ],
  "assignee": "jared@goatbytes.io",
  "reporter": "jared@goatbytes.io",
  "blocked_by": [],
  "blocks": [],
  "comments": [],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 0,
  "story_points": 5,
  "order": 0,
  "custom_fields": {}
}