{
  "created_at": "2025-12-02T18:08:29.086634",
  "updated_at": "2025-12-03T02:16:16.573173Z",
  "id": "SOUL-219",
  "uuid": "c709a413-f218-4816-97a3-19c732a13e26",
  "title": "Fix stdin handling tests in CLI module",
  "description": "**As a** Consoul developer\n**I want** stdin handling tests to pass\n**So that** we can ensure piped input works correctly\n\n**Context:**\n5 tests in tests/cli/test_stdin.py are failing with AttributeError: '_io.BytesIO' object has no attribute 'buffer'. Tests are attempting to read from stdin but the mock BytesIO object doesn't have the expected buffer attribute.\n\n**Technical Notes:**\n- tests/cli/test_stdin.py - Stdin tests\n- Error: AttributeError: '_io.BytesIO' object has no attribute 'buffer'\n- Root cause: Test mocks use BytesIO but code expects sys.stdin.buffer\n\n**Acceptance Criteria:**\n\n**Given** stdin contains content\n**When** read_stdin is called\n**Then** content should be read correctly\n\n**Given** stdin is empty\n**When** read_stdin is called\n**Then** it should handle gracefully\n\n**Failing Tests:**\n- test_read_stdin_with_content\n- test_read_stdin_empty\n- test_read_stdin_size_limit\n- test_read_stdin_invalid_utf8\n- test_read_stdin_multiline\n\n**Testing Considerations:**\n- Mock sys.stdin.buffer correctly\n- Test UTF-8 encoding/decoding\n- Verify size limits\n\n**Implementation Hints:**\n- Use io.BytesIO with a wrapper that has .buffer attribute\n- Or mock sys.stdin.buffer directly instead of sys.stdin\n- Example: mock_stdin.buffer = BytesIO(b\"content\")",
  "status": "done",
  "type": "bug",
  "priority": "medium",
  "labels": [
    "testing",
    "bug",
    "cli"
  ],
  "reporter": "jared@goatbytes.io",
  "parent_id": "SOUL-214",
  "blocked_by": [],
  "blocks": [],
  "comments": [
    {
      "created_at": "2025-12-02T18:16:00.703620",
      "updated_at": "2025-12-02T18:16:00.703621",
      "id": "20251202181600-c76dce72",
      "ticket_id": "SOUL-219",
      "author": "jared@goatbytes.io",
      "content": "Fixed all 5 failing tests by creating a MockStdin class that properly wraps BytesIO with a .buffer attribute.\n\nRoot cause: The read_stdin() function accesses sys.stdin.buffer.read(), but the test mocks were setting sys.stdin directly to a BytesIO object, which doesn't have a .buffer attribute.\n\nSolution implemented:\n1. Created a MockStdin helper class at module level\n2. MockStdin wraps a BytesIO object and exposes it via .buffer attribute\n3. Updated all 6 tests in TestReadStdin to use the new MockStdin class\n4. Simplified test code by removing duplicate mock class definitions\n5. Made is_tty configurable via constructor parameter\n\nAll tests now pass:\n✓ test_read_stdin_with_content\n✓ test_read_stdin_empty\n✓ test_read_stdin_size_limit\n✓ test_read_stdin_invalid_utf8\n✓ test_read_stdin_multiline\n✓ test_read_stdin_from_tty (bonus - was passing before but now cleaner)\n\nCommit: 2295ac4",
      "edited": false,
      "edit_count": 0,
      "is_ai_generated": false,
      "attachments": [],
      "attachment_count": 0
    }
  ],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 1,
  "story_points": 2,
  "order": 0,
  "custom_fields": {}
}