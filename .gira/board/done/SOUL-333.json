{
  "created_at": "2025-12-30T02:06:30.276952Z",
  "updated_at": "2025-12-30T05:29:52.977057Z",
  "id": "SOUL-333",
  "uuid": "1ca43b0c-7446-4789-be11-3363aa289ff3",
  "_version": 1,
  "title": "Add SDK usage examples for common integration patterns",
  "description": "**As a** backend developer integrating Consoul into existing applications\n**I want** clear, runnable examples for common integration patterns\n**So that** I can quickly implement Consoul in FastAPI, Flask, and async environments with best practices\n\n**Context:**\nThe SDK (`src/consoul/sdk/`) provides high-level factories like `create_session()`, `restore_session()`, and `Consoul()` for headless AI conversation management. While examples exist in `examples/sdk/` and `examples/backend/`, they are scattered and lack a consolidated directory for framework-specific integration patterns.\n\n**Research Findings:**\n- FastAPI integration is well-covered in `examples/backend/fastapi_sessions.py` (~540 lines) and `examples/sdk/backend/` directory (5 files)\n- Flask is mentioned in `docs/api/integration-guide.md` but NO actual example file exists\n- Custom tools example exists at `examples/sdk/tool_specification/03_custom_tools.py` but focuses on tool creation, not registration patterns in backends\n- Async streaming patterns are in `examples/sdk/websocket_streaming.py` but could benefit from a simpler pure-async example\n- SDK exports `Consoul`, `create_session`, `restore_session`, `ConversationService` for various integration levels\n\n**Similar Tools Reference:**\n- LangChain provides integration examples per-framework\n- aider shows CLI integration patterns\n- shell-gpt demonstrates simple SDK patterns\n\n**Technical Notes:**\n- Create new `examples/sdk/integrations/` directory for organized integration examples\n- Reference SDK factories from `src/consoul/sdk/__init__.py` (lines 42-48): `Consoul`, `create_session`, `restore_session`, `save_session_state`\n- Use `ConversationService` from `src/consoul/sdk/services/conversation.py` for async streaming\n- Follow existing security patterns from `examples/backend/fastapi_sessions.py` (CORS warnings, session isolation)\n- Follow docstring style from existing examples (usage instructions, security notes)\n- Each example should be self-contained and runnable with `python examples/sdk/integrations/<file>.py`\n\n**Files to Create:**\n1. `examples/sdk/integrations/fastapi_backend.py` - Full FastAPI integration showcasing:\n   - HTTP chat endpoint with session management\n   - WebSocket streaming endpoint\n   - Proper CORS configuration\n   - Health/readiness endpoints\n   - Session cleanup patterns\n   \n2. `examples/sdk/integrations/flask_backend.py` - Flask integration showcasing:\n   - HTTP chat endpoint\n   - Session management with `create_session()`/`restore_session()`\n   - Proper error handling\n   - Request validation\n   - Cost tracking\n   \n3. `examples/sdk/integrations/async_usage.py` - Pure async patterns showcasing:\n   - Direct `ConversationService` usage\n   - `async for` token streaming\n   - Concurrent conversation handling\n   - asyncio integration patterns\n   - No web framework dependency\n   \n4. `examples/sdk/integrations/custom_tools.py` - Registering custom tools showcasing:\n   - `@tool` decorator usage in backends\n   - `BaseTool` class for advanced control\n   - Mixing custom tools with built-in tools\n   - Tool approval patterns for backends\n   - Per-session tool filtering with `ToolFilter`\n   \n5. `examples/sdk/integrations/README.md` - Integration guide explaining:\n   - When to use each pattern\n   - API level comparison (Consoul vs ConversationService)\n   - Security considerations\n   - Links to each example\n\n**Acceptance Criteria:**\n\n**Given** a developer wants to integrate Consoul with FastAPI\n**When** they run `python examples/sdk/integrations/fastapi_backend.py`\n**Then** a functional FastAPI server starts with chat endpoints documented via OpenAPI\n\n**Given** a developer wants to integrate Consoul with Flask\n**When** they run `python examples/sdk/integrations/flask_backend.py`\n**Then** a functional Flask server starts with documented endpoints\n\n**Given** a developer needs pure async patterns without a web framework\n**When** they read `examples/sdk/integrations/async_usage.py`\n**Then** they find clear examples of `ConversationService` with `async for` streaming\n\n**Given** a developer needs to register custom tools in a backend\n**When** they review `examples/sdk/integrations/custom_tools.py`\n**Then** they find patterns for `@tool` decorator, `BaseTool`, and `ToolFilter` usage\n\n**Given** a developer is new to Consoul SDK\n**When** they read `examples/sdk/integrations/README.md`\n**Then** they understand which integration pattern to use for their use case\n\n**Testing Considerations:**\n- Each example should be syntax-checked (python -m py_compile)\n- Examples should import successfully from consoul.sdk\n- FastAPI/Flask examples should start without errors\n- Include docstrings with example curl commands for testing\n- Manual testing: verify each example runs and responds correctly\n- Add security warnings consistent with existing examples\n\n**Implementation Hints:**\n- Reference `examples/backend/fastapi_sessions.py` for FastAPI patterns (session store, WebSocket approval)\n- Reference `examples/sdk/backend/multi_tenant_http.py` for session locking patterns\n- Use `from consoul.sdk import Consoul, create_session, restore_session, save_session_state`\n- Use `from consoul.sdk.services import ConversationService` for low-level async\n- Use `from consoul.sdk import ToolFilter` for tool sandboxing (see `src/consoul/sdk/models.py`:390-460)\n- Follow Flask patterns from `examples/sdk/web_approval_provider.py` (uses Flask for approval server)\n- Include CORS/security warnings matching `examples/backend/fastapi_sessions.py` style\n- Add \"Security Notes\" docstring section to each file\n- Keep examples under 200 lines each for readability\n- Use `gpt-4o-mini` as default model in examples (cost-effective for demos)",
  "status": "done",
  "type": "feature",
  "priority": "medium",
  "labels": [
    "sdk",
    "documentation",
    "examples",
    "developer-experience"
  ],
  "assignee": "jared@goatbytes.io",
  "reporter": "jared@goatbytes.io",
  "epic_id": "EPIC-016",
  "blocked_by": [],
  "blocks": [],
  "comments": [],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 0,
  "story_points": 3,
  "order": 0,
  "custom_fields": {}
}