{
  "created_at": "2026-01-01T10:43:31.013322Z",
  "updated_at": "2026-01-01T21:22:54.381508Z",
  "id": "SOUL-351",
  "uuid": "8ea1be5d-9fb5-4138-a6e6-935b56f440a0",
  "_version": 3,
  "title": "Make FileSessionStore session ID mapping collision-proof",
  "description": "**As a** Consoul SDK user\n**I want** FileSessionStore to preserve distinct session IDs without filename collisions\n**So that** sessions cannot overwrite each other or leak data across tenants\n\n**Context:**\n`FileSessionStore._get_session_path` strips non-alphanumeric characters (`src/consoul/sdk/session_store.py:429`), which can collapse different IDs (e.g., `alice:conv1` and `aliceconv1`) into the same filename. This risks data loss and cross-tenant exposure when namespaces are used.\n\n**Technical Notes:**\n- `src/consoul/sdk/session_store.py:429`\n- `tests/sdk/test_list_sessions.py:158` (namespace expectations)\n- `tests/sdk/test_session_serialization.py:673` (FileSessionStore coverage)\n\n**Acceptance Criteria:**\n**Given** two different session IDs that normalize to the same sanitized string today\n**When** they are saved via FileSessionStore\n**Then** they are stored in distinct files and can be loaded independently\n\n**Given** a session ID containing namespaces (e.g., `user:conv1`)\n**When** it is saved and later listed\n**Then** list_sessions returns the original session ID without mutation\n\n**Testing Considerations:**\n- Add regression tests for collision cases and namespaced IDs\n- Verify list_sessions still returns stable ordering\n\n**Implementation Hints:**\n- Use a collision-proof encoding for filenames (e.g., URL-safe base64 of the full session_id) or a SHA-256 hash with the original ID stored in the file for lookup\n- Ensure filename mapping is deterministic and reversible or recoverable via file contents",
  "status": "review",
  "type": "bug",
  "priority": "high",
  "labels": [
    "core",
    "bug",
    "security"
  ],
  "assignee": "jared@goatbytes.io",
  "reporter": "jared@goatbytes.io",
  "blocked_by": [],
  "blocks": [],
  "comments": [
    {
      "created_at": "2026-01-02T05:22:54.381349Z",
      "updated_at": "2026-01-02T05:22:54.381353Z",
      "id": "20260101212254-17359cfe",
      "ticket_id": "SOUL-351",
      "author": "jared@goatbytes.io",
      "content": "Implementation complete. Key decisions:\n\n1. **Encoding approach**: Chose URL-safe Base64 over SHA-256 hash because:\n   - Bijective (guaranteed no collisions)\n   - Reversible (can decode filename to see original ID for debugging)\n   - Deterministic\n   - Already used elsewhere in codebase (encryption_hook.py)\n\n2. **No backwards compatibility**: Since the SDK hasn't been deployed yet, we opted not to add legacy filename fallback logic. This keeps the implementation simpler. If needed later, fallback can be added to `load()` to check both new and old filename formats.\n\n3. **Security**: Base64 encoding is inherently path-traversal safe since it cannot produce `/` or `..` sequences in the output.\n\nTests added for collision prevention, special characters, namespace filtering, and path traversal attacks.",
      "edited": false,
      "edit_count": 0,
      "is_ai_generated": false,
      "attachments": [],
      "attachment_count": 0
    }
  ],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 1,
  "story_points": 3,
  "order": 0,
  "custom_fields": {}
}