{
  "created_at": "2025-12-31T05:21:10.068031Z",
  "updated_at": "2025-12-31T21:04:54.526283Z",
  "id": "SOUL-341",
  "uuid": "6640be58-d609-4372-80ce-efa78583222f",
  "_version": 1,
  "title": "Document multi-tenancy isolation patterns",
  "description": "**As a** platform engineer deploying Consoul in a multi-tenant environment\n**I want** comprehensive documentation of multi-tenancy patterns and isolation guarantees\n**So that** I can securely deploy Consoul for multiple tenants with proper data boundaries\n\n**Context:**\nThe SDK includes session namespace utilities in `src/consoul/sdk/session_id.py` that support tenant:user:session patterns, but production deployment patterns are undocumented. Key concerns for multi-tenant deployments:\n- Data isolation between tenants\n- API key management per tenant\n- Rate limiting per tenant\n- Session storage isolation\n- Audit logging and compliance\n\n**Technical Notes:**\n- Session ID utilities: `src/consoul/sdk/session_id.py` (lines 1-431)\n- Session namespace pattern: `{tenant}:{user}:{session}`\n- SessionIdBuilder class for constructing namespaced IDs\n- parse_session_id() for extracting tenant/user components\n- Redis key prefix: configurable via `SessionConfig.key_prefix`\n- Rate limit tiers: `src/consoul/server/middleware/rate_limit.py` lines 228-286\n\n**Documentation Sections to Create:**\n\n**1. Tenant Isolation Strategies**\n- Session namespace conventions (tenant:user:session)\n- Redis key isolation (prefix per tenant vs shared)\n- API key patterns for tenant identification\n- Cross-tenant request prevention\n\n**2. Data Boundaries**\n- Session data isolation in Redis\n- Conversation history scoping\n- Tool execution context isolation\n- Audit log segmentation\n\n**3. Tenant-Specific Rate Limits**\n- Using tier_limits for per-tenant quotas\n- api_key_tiers patterns (tenant-* wildcards)\n- Fair-share policies across tenants\n- Burst handling per tenant\n\n**4. Security Considerations**\n- Tenant ID validation and injection prevention\n- Session ID enumeration attacks\n- Cross-tenant information disclosure risks\n- API key rotation per tenant\n\n**5. Deployment Patterns**\n- Single-tenant deployment (simplest)\n- Multi-tenant shared infrastructure\n- Tenant-isolated Redis instances\n- Hybrid patterns\n\n**6. Example Configurations**\n- Rate limiting: `CONSOUL_API_KEY_TIERS='{\"tenant-a-*\": \"premium\", \"tenant-b-*\": \"basic\"}'`\n- Session prefix: `CONSOUL_SESSION_KEY_PREFIX='consoul:{tenant}:session:'`\n- Audit logging integration\n\n**Acceptance Criteria:**\n\n**Given** a developer needs to deploy Consoul for multiple tenants\n**When** they read the multi-tenancy documentation\n**Then** they understand session namespace conventions and isolation patterns\n\n**Given** documentation exists for tenant isolation\n**When** reviewing security aspects\n**Then** cross-tenant attack vectors and mitigations are clearly explained\n\n**Given** rate limiting documentation exists\n**When** configuring per-tenant limits\n**Then** examples show exact environment variable configurations\n\n**Given** deployment patterns are documented\n**When** choosing an architecture\n**Then** trade-offs between patterns are clearly explained\n\n**Testing Considerations:**\n- Review documentation with security team\n- Test example configurations for accuracy\n- Verify session isolation claims with integration tests\n- Include runnable code examples\n\n**Implementation Hints:**\n- Create `docs/deployment/multi-tenancy.md`\n- Include architecture diagrams (Mermaid)\n- Reference existing code with line numbers\n- Add practical examples from session_id.py usage\n- Cross-reference with authentication and rate limiting docs\n- Consider adding tenant isolation integration tests",
  "status": "review",
  "type": "task",
  "priority": "high",
  "labels": [
    "documentation",
    "security",
    "server",
    "multi-tenancy"
  ],
  "reporter": "jared@goatbytes.io",
  "epic_id": "EPIC-021",
  "blocked_by": [],
  "blocks": [],
  "comments": [],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 0,
  "story_points": 5,
  "order": 0,
  "custom_fields": {}
}