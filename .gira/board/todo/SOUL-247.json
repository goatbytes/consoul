{
  "created_at": "2025-12-10T00:51:49.977401",
  "updated_at": "2025-12-10T00:51:49.977414",
  "id": "SOUL-247",
  "uuid": "62846c27-e998-42d8-96d4-c5a6ddc2db2a",
  "title": "Create ModelService facade for model management",
  "description": "**As a** Consoul developer\n**I want** a ModelService facade for model initialization and management\n**So that** model operations are abstracted from UI code and reusable across implementations\n\n**Context:**\nCurrently, tui/app.py contains ~347 lines of model management logic:\n- Model initialization from config (lines 260-607)\n- Tool binding to models (lines 567-607, 40 lines)\n- Model switching and provider detection\n\nAdditionally, tui/widgets/model_picker_modal.py has 600+ lines of hardcoded model catalog data that should be in SDK.\n\n**Technical Notes:**\n- Extract from: src/consoul/tui/app.py lines 260-607\n- Extract model catalog from: src/consoul/tui/widgets/model_picker_modal.py lines 32-293\n- Create new: src/consoul/sdk/services/model.py\n- Create new: src/consoul/sdk/models/catalog.py (model catalog)\n- Hide: BaseChatModel, tool binding mechanics from callers\n- Provide: get_model(), switch_model(), list_models() interface\n- Use: Existing consoul/ai/providers.py get_chat_model()\n- Reference: CLI analysis showed clean model usage patterns\n\n**Acceptance Criteria:**\n\n**Given** I have a ModelService instance\n**When** I call get_model()\n**Then** I receive an initialized, tool-bound model ready to use\n\n**Given** I want to switch models\n**When** I call switch_model(model_name)\n**Then** The model is reinitialized and tools are re-bound\n\n**Given** I need a list of available models\n**When** I call list_models(provider=None)\n**Then** I receive ModelInfo dataclasses with provider, context limits, and capabilities\n\n**Given** A model requires an API key not configured\n**When** get_model() is called\n**Then** Clear error message indicates missing API key\n\n**Testing Considerations:**\n- Mock get_chat_model() from providers\n- Test model initialization with different configs\n- Test tool binding integration\n- Test provider-specific error handling\n- Test model catalog data structure\n- Verify model switching preserves conversation\n\n**Implementation Hints:**\n- Create ModelService class with from_config() factory\n- Extract _initialize_ai_model() from app.py:260-607\n- Extract _bind_tools_to_model() from app.py:567-607\n- Move model catalog from model_picker_modal.py to sdk/models/catalog.py\n- Return ModelInfo dataclass with provider, context_window, supports_vision, etc.\n- Integrate with existing ToolService for tool binding\n- Provide get_current_model() property\n- Cache initialized models for performance",
  "status": "todo",
  "type": "feature",
  "priority": "high",
  "labels": [
    "sdk",
    "refactor",
    "ai",
    "providers"
  ],
  "reporter": "jared@goatbytes.io",
  "epic_id": "EPIC-013",
  "blocked_by": [],
  "blocks": [],
  "comments": [],
  "attachments": [],
  "attachment_count": 0,
  "comment_count": 0,
  "story_points": 5,
  "order": 0,
  "custom_fields": {}
}