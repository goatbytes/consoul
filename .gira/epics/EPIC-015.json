{
  "created_at": "2025-12-16T13:56:23.513570",
  "updated_at": "2025-12-16T15:48:25.983740",
  "id": "EPIC-015",
  "title": "SDK Decoupling & Domain-Agnostic Design",
  "description": "Transform Consoul from a coding-assistant-focused SDK into a general-purpose LLM integration library suitable for any domain (legal AI, medical chatbots, customer support, etc.).\n\n## Vision\nEnable developers to use Consoul as a headless SDK without TUI/CLI/profile concepts, while maintaining backward compatibility for existing users.\n\n## Problem Statement\nCurrent architecture couples SDK to profiles and coding assistant assumptions:\n- Profiles bundle system prompts, model config, and context settings\n- Context injection assumes coding use case (git info, working directory)\n- SDK constructor requires profile parameter\n- Provider-specific parameters only configurable via static config files\n- No extensibility for domain-specific context injection\n\nThis prevents Consoul from serving projects like:\n- Richard (workers compensation legal AI)\n- Medical chatbots requiring patient context\n- Customer support bots with CRM integration\n- General-purpose AI agents in non-coding domains\n\n## Goals\n1. **Profile-Optional SDK**: Use Consoul without any profile dependency\n2. **Flexible Context**: Control what gets injected (not all-or-nothing booleans)\n3. **Provider Params**: Pass provider-specific options at runtime\n4. **Extensible Context**: Plugin architecture for domain-specific knowledge\n5. **Backward Compatible**: Existing profile/CLI/TUI usage unaffected\n\n## Architecture Principles\n- **SDK First**: Core library has no TUI/CLI dependencies\n- **Explicit Over Implicit**: Users control configuration, no magic defaults\n- **Domain Agnostic**: No assumptions about use case (coding vs legal vs medical)\n- **Layered**: TUI/CLI layer can still use profiles as convenience\n- **Extensible**: Protocol-based extension points for custom behavior\n\n## Success Metrics\n- Consoul SDK can be used for legal AI (Richard project) with clean integration\n- Medical/customer support examples documented and working\n- Zero breaking changes for existing CLI/TUI users\n- Profile system remains optional convenience layer\n- Documentation shows domain-specific patterns\n\n## Phases\n\n### Phase 1: Foundation (Quick Wins)\n- SOUL-285: Profile-optional constructor (5 pts)\n- SOUL-287: Flexible prompt builder (3 pts)\n- SOUL-288: Provider-specific params (3 pts)\n\n### Phase 2: Architecture (Future Work)\n- SOUL-289: Decouple profiles from SDK core (13 pts) - Breaking change\n- SOUL-290: Extensible context injection (8 pts)\n\n## Timeline\n- Phase 1: 1-2 weeks (enables Richard and other projects)\n- Phase 2: 2-3 weeks (major refactor, requires version bump)\n\n## Dependencies\n- No blockers for Phase 1\n- Phase 2 (SOUL-289) requires Phase 1 completion\n\n## Related Work\n- EPIC-002: Core AI & Configuration System (completed)\n- EPIC-011: WebSocket/FastAPI Backend Support (active)",
  "status": "active",
  "owner": "jared@goatbytes.io",
  "labels": [],
  "tickets": [
    "SOUL-285",
    "SOUL-287",
    "SOUL-288",
    "SOUL-289",
    "SOUL-290"
  ],
  "comments": [
    {
      "created_at": "2025-12-16T15:48:25.983614",
      "updated_at": "2025-12-16T15:48:25.983616",
      "id": "20251216154825-50a03b3e",
      "epic_id": "EPIC-015",
      "author": "jared@goatbytes.io",
      "content": "## Readiness Assessment & Implementation Plan\n\n**Current Status**: Draft phase - needs design refinement before coding\n\n### Critical Gaps Identified\n\n1. **Backward Compatibility**: No migration path or shims documented\n2. **Acceptance Criteria**: Missing concrete done/verify steps per ticket\n3. **Domain Extensibility**: Plugin interface not specified\n4. **Testing Strategy**: No regression test plan\n5. **Documentation**: No outline for domain-specific guides\n6. **Versioning**: Breaking changes without version bump plan\n\n### Pre-Implementation Requirements\n\n**Phase 0: Design & Planning (Before SOUL-285)**\n\n1. **API Design Document** (BLOCKING)\n   - Constructor signature: Consoul(model, profile=None, system_prompt=None, persist=True, db_path=None, ...)\n   - Defaults when profile=None vs profile=\"default\"\n   - Parameter precedence: explicit params > profile settings\n   - Error cases: invalid params, missing required fields\n   - Sketch: examples/design/sdk_api_sketch.py\n\n2. **Compatibility Strategy** (BLOCKING)\n   - Keep profile path intact (no breaking changes in Phase 1)\n   - Add deprecation warnings for profile-dependent SDK patterns\n   - Document migration: profile-based â†’ explicit params\n   - Version plan: Phase 1 (v0.5.0), Phase 2 (v1.0.0 - breaking)\n\n3. **Testing Plan** (BLOCKING)\n   - Dual-path tests: profile vs profile-free constructors\n   - Provider param validation per provider schema\n   - Context plugin contract tests\n   - Regression suite: existing CLI/TUI workflows unchanged\n   - Domain examples: legal/medical/support test scripts\n\n### Recommended Implementation Order\n\n**Phase 1: Foundation (v0.5.0 - Non-Breaking)**\n\n1. SOUL-288 (Provider params) - Low risk, high value\n   - Add **model_kwargs to Consoul.__init__()\n   - Validate against provider ModelConfig schemas\n   - Document per-provider options\n\n2. SOUL-285 (Profile-optional) - Core enabler\n   - Make profile Optional[str] = \"default\" (backward compat)\n   - Extract conversation params to constructor\n   - Deprecation warning when relying on implicit profile behavior\n\n3. SOUL-287 (Flexible prompt) - Context control\n   - Add granular context kwargs to build_enhanced_system_prompt()\n   - Keep boolean flags with deprecation warnings\n   - Document context composition patterns\n\n**Phase 2: Architecture (v1.0.0 - Breaking)**\n\n4. SOUL-289 (Decouple profiles) - Breaking refactor\n   - Move ProfileConfig to consoul.cli/tui modules\n   - Remove profile fields from ConsoulConfig\n   - Migration guide with examples\n\n5. SOUL-290 (Context plugins) - Extensibility\n   - Define ContextProvider protocol\n   - Plugin composition and ordering\n   - Domain-specific examples\n\n### Acceptance Criteria per Ticket\n\n**SOUL-285**: Constructor accepts all params without profile; defaults work; backward compat verified; docs updated\n**SOUL-287**: Granular context control works; no implicit injections; CLI/TUI unchanged\n**SOUL-288**: Provider params validated and passed through; error messages clear; all providers documented\n**SOUL-289**: Profiles optional; SDK works without them; migration guide published; v1.0.0 tagged\n**SOUL-290**: Context plugins work; examples for 3 domains; protocol documented\n\n### Dependency Coordination\n\n- **EPIC-011** (Backend): Reuse async conversation services\n- **EPIC-012** (Decoupling): Align on SDK/TUI separation patterns\n- No circular dependencies on profile system\n\n### Risk Mitigation\n\n1. **Breaking Changes**: Defer to Phase 2 (SOUL-289)\n2. **Compatibility**: Maintain profile=\"default\" behavior in Phase 1\n3. **Testing**: Comprehensive dual-path regression suite\n4. **Documentation**: Migration guide + domain examples\n\n### Next Actions (Before Starting SOUL-285)\n\n- [ ] Draft API design document with constructor signatures\n- [ ] Write compatibility/migration plan\n- [ ] Create test plan outline\n- [ ] Schedule design review\n- [ ] Update ticket acceptance criteria with concrete APIs",
      "edited": false,
      "edit_count": 0,
      "is_ai_generated": false,
      "attachments": [],
      "attachment_count": 0
    }
  ],
  "comment_count": 1,
  "attachments": [],
  "attachment_count": 0,
  "custom_fields": {}
}